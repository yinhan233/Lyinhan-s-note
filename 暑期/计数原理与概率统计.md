# 计数原理与概率统计

## 一、加法原理与乘法原理
### 1. 加法原理
若完成一件事有 $n$ 类**互斥**方案，第 $i$ 类方案有 $m_i$ 种方法，则总方法数为：  
$$N = m_1 + m_2 + \cdots + m_n$$  
**本质**：分类计数，类类独立  
**应用场景**：  
- 从北京到上海可选高铁/飞机/汽车  
- 学生选课有4门文科和2门理科可选  

### 2. 乘法原理
若完成一件事需 $k$ 个**步骤**，第 $i$ 步有 $m_i$ 种方法，则总方法数为：  
$$N = m_1 \times m_2 \times \cdots \times m_k$$  
**本质**：分步计数，步步相关  
**应用场景**：  
- 密码锁有4位，每位0-9  
- 从A地经B地到C地的路线选择  

**区别**：  
- 加法原理 → "或"关系 → 分类  
- 乘法原理 → "与"关系 → 分步  

---

## 二、排列与组合
### 1. 排列（有序）
- **定义**：从 $n$ 个不同元素中取出 $m$ 个元素（$m \leq n$）并按一定顺序排列  
- **公式**：  
  $$P_n^m = A_n^m = n(n-1)(n-2)\cdots(n-m+1) = \frac{n!}{(n-m)!}$$  
  **推导**：  
  第1位：$n$ 种选择  
  第2位：$n-1$ 种选择  
  $\vdots$  
  第 $m$ 位：$n-m+1$ 种选择  
  $\therefore$ 总数 $= n(n-1)\cdots(n-m+1)$  

### 2. 组合（无序）
- **定义**：从 $n$ 个不同元素中取出 $m$ 个元素（$m \leq n$）为一组  
- **公式**：  
  $$C_n^m = \binom{n}{m} = \frac{A_n^m}{m!} = \frac{n!}{m!(n-m)!}$$  
  **推导**：  
  排列数 $A_n^m$ 包含顺序信息  
  每组元素有 $m!$ 种排列方式  
  $\therefore$ 组合数 $= \frac{A_n^m}{m!}$  

### 3. 组合数性质
| 性质 | 公式 | 解释 |
|------|------|------|
| 对称性 | $\binom{n}{k} = \binom{n}{n-k}$ | 选k个与留n-k个等价 |
| 递推关系 | $\binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1}$ | 帕斯卡三角基础 |
| 单峰性 | $\binom{n}{k}$ 在 $k=\lfloor n/2 \rfloor$ 时最大 | - |
| 二项式系数和 | $\sum_{k=0}^{n} \binom{n}{k} = 2^n$ | $(1+1)^n$ 展开 |
| 奇偶项和 | $\sum_{k=0}^{\lfloor n/2 \rfloor} \binom{n}{2k} = \sum_{k=0}^{\lfloor n/2 \rfloor} \binom{n}{2k+1} = 2^{n-1}$ | $(1-1)^n=0$ 展开 |

### 4. 常用模型
- **分组问题**：$n$ 个元素分成 $k$ 组（组间无序）  
  $$\frac{\binom{n}{a_1}\binom{n-a_1}{a_2}\cdots\binom{a_k}{a_k}}{k!} \quad (\sum a_i=n)$$
- **隔板法**：$n$ 个相同元素分给 $k$ 人（每人至少1个）  
  $$\binom{n-1}{k-1}$$
- **圆排列**：$n$ 个不同元素环形排列  
  $$(n-1)!$$

---

## 三、二项式定理
### 1. 二项式定理
$$(a+b)^n = \sum_{k=0}^{n} \binom{n}{k} a^{n-k}b^k$$

### 2. 通项公式
$$T_{k+1} = \binom{n}{k} a^{n-k}b^k \quad (k=0,1,2,\cdots,n)$$

### 3. 二项式系数性质
| 性质 | 表达式 | 赋值法 |
|------|--------|--------|
| 系数和 | $\sum_{k=0}^{n} \binom{n}{k} = 2^n$ | $a=b=1$ |
| 奇偶项和 | $\sum_{k=0}^{n} (-1)^k \binom{n}{k} = 0$ | $a=1,b=-1$ |
| 奇数项和 | $\sum_{k=0}^{\lfloor n/2 \rfloor} \binom{n}{2k} = 2^{n-1}$ | $a=1,b=1$ 和 $a=1,b=-1$ 相加 |
| 偶数项和 | $\sum_{k=0}^{\lfloor n/2 \rfloor} \binom{n}{2k+1} = 2^{n-1}$ | 同上 |

### 4. 解题技巧
1. **通项应用**：求特定项系数（注意项数 $k+1$ 与指数关系）
2. **多项式展开**：$(a+b+c)^n = \sum \frac{n!}{i!j!k!}a^ib^jc^k \ (i+j+k=n)$
3. **赋值法应用**：
   - 求系数和：令变量为1
   - 求奇偶项系数差：令变量为-1
4. **常数项处理**：令变量为0
5. **有理项判断**：指数为整数

**例题**：求 $(x^2 + \frac{1}{x})^8$ 展开式中常数项  
解：$T_{k+1} = \binom{8}{k} (x^2)^{8-k} (\frac{1}{x})^k = \binom{8}{k} x^{16-3k}$  
令 $16-3k=0$，得 $k=\frac{16}{3}$（非整数）→ 无常数项

---

## 四、概率基础
### 1. 核心概念
| 概念 | 定义 | 符号 |
|------|------|------|
| 样本空间 | 所有可能结果的集合 | $\Omega$ |
| 基本事件 | 样本空间的单元素子集 | $e_i$ |
| 随机事件 | 样本空间的子集 | $A,B$ |
| 必然事件 | 整个样本空间 | $\Omega$ |
| 不可能事件 | 空集 | $\varnothing$ |

### 2. 事件关系
| 关系 | 定义 | 概率公式 |
|------|------|----------|
| 包含 | $A \subseteq B$ | $P(A) \leq P(B)$ |
| 互斥 | $A \cap B = \varnothing$ | $P(A \cup B) = P(A) + P(B)$ |
| 对立 | $A \cap \bar{A} = \varnothing$，$A \cup \bar{A} = \Omega$ | $P(\bar{A}) = 1 - P(A)$ |
| 独立 | $P(AB) = P(A)P(B)$ | $P(A \cup B) = 1 - P(\bar{A})P(\bar{B})$ |

### 3. 概率公式
1. **古典概型**：$P(A) = \frac{|A|}{|\Omega|}$（有限等可能）
2. **加法公式**：$P(A \cup B) = P(A) + P(B) - P(AB)$
3. **减法公式**：$P(A - B) = P(A) - P(AB)$
4. **对立事件**：$P(A) = 1 - P(\bar{A})$

### 4. 伯努利概型
$n$ 次独立重复试验，事件 $A$ 发生概率为 $p$，则 $k$ 次发生的概率：  
$$P_n(k) = \binom{n}{k} p^k (1-p)^{n-k}$$

### 5. 全概率公式
若 $A_1,A_2,\cdots,A_n$ 构成完备事件组，则：  
$$P(B) = \sum_{i=1}^{n} P(A_i)P(B|A_i)$$

---

## 五、随机变量与分布
### 1. 离散型随机变量
| 分布 | 概率分布 | 期望 | 方差 |
|------|----------|------|------|
| **二项分布**<br>$X \sim B(n,p)$ | $P(X=k)=\binom{n}{k}p^k(1-p)^{n-k}$ | $E(X)=np$ | $D(X)=np(1-p)$ |
| **超几何分布**<br>$X \sim H(N,M,n)$ | $P(X=k)=\frac{\binom{M}{k}\binom{N-M}{n-k}}{\binom{N}{n}}$ | $E(X)=n\frac{M}{N}$ | $D(X)=n\frac{M}{N}(1-\frac{M}{N})\frac{N-n}{N-1}$ |
| **泊松分布**<br>$X \sim P(\lambda)$ | $P(X=k)=\frac{\lambda^k e^{-\lambda}}{k!}$ | $E(X)=\lambda$ | $D(X)=\lambda$ |

### 2. 连续型随机变量
**正态分布 $X \sim N(\mu,\sigma^2)$**：
- 密度函数：$f(x)=\frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}$
- 性质：
  - 曲线关于 $x=\mu$ 对称
  - $P(\mu-\sigma < X < \mu+\sigma) \approx 68.3\%$
  - $P(\mu-2\sigma < X < \mu+2\sigma) \approx 95.4\%$
  - $P(\mu-3\sigma < X < \mu+3\sigma) \approx 99.7\%$

**标准正态分布**：$Z \sim N(0,1)$
- 分布函数：$\Phi(z) = P(Z \leq z)$
- 性质：$\Phi(-z) = 1 - \Phi(z)$

### 3. 数字特征
1. **期望**：
   - 定义：$E(X)=\sum x_i p_i$（离散），$E(X)=\int_{-\infty}^{\infty} x f(x)dx$（连续）
   - 性质：
     - $E(aX+b)=aE(X)+b$
     - $E(X+Y)=E(X)+E(Y)$（不要求独立）
2. **方差**：
   - 定义：$D(X)=E[(X-E(X))^2]=E(X^2)-[E(X)]^2$
   - 性质：
     - $D(aX+b)=a^2 D(X)$
     - $D(X+Y)=D(X)+D(Y)$（当 $X,Y$ 独立时）

---

## 六、统计推断
### 1. 抽样方法
| 方法 | 操作 | 适用场景 |
|------|------|----------|
| 简单随机抽样 | 抽签/随机数表 | 小规模同质总体 |
| 分层抽样 | 按特征分层后抽样 | 有明显类别差异 |
| 系统抽样 | 固定间隔抽样 | 流水线产品检测 |
| 整群抽样 | 随机抽取群体后普查 | 地域分布广的群体 |
### 2. 数字特征估计
| 参数 | 总体参数 | 样本估计量 | 计算公式 |
|------|----------|------------|----------|
| 均值 | $\mu$ | $\bar{x}$ | $\bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i$ |
| 方差 | $\sigma^2$ | $s^2$ | $s^2 = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2$ |
| 标准差 | $\sigma$ | $s$ | $s = \sqrt{s^2}$ |

**推导说明**：
- **样本方差分母 $n-1$ 的原因**：  
  使用 $n-1$（称为贝塞尔校正）可使 $s^2$ 成为 $\sigma^2$ 的无偏估计  
  $E(s^2) = \sigma^2$  
  若用 $n$ 则 $E(\frac{1}{n}\sum(x_i-\bar{x})^2) = \frac{n-1}{n}\sigma^2 < \sigma^2$

**百分位数计算**：
1. 数据升序排列：$x_{(1)} \leq x_{(2)} \leq \cdots \leq x_{(n)}$
2. 计算位置：$i = (n+1) \times p\%$
3. 结果：
   - 若 $i$ 为整数 → $x_p = x_{(i)}$
   - 若 $i$ 非整数 → $x_p = \frac{x_{(\lfloor i \rfloor)} + x_{(\lceil i \rceil)}}{2}$

**示例**：  
数据：[3,5,7,8,10,12,13,15,16,18]（$n=10$）  
求第30百分位数：  
$i = (10+1)×0.3 = 3.3$  
$x_{30} = \frac{x_{(3)} + x_{(4)}}{2} = \frac{7+8}{2} = 7.5$

---

### 3. 相关分析与回归
#### (1) 相关系数
$$r = \frac{\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i-\bar{x})^2} \sqrt{\sum_{i=1}^{n}(y_i-\bar{y})^2}}$$

**性质**：
- $|r| \leq 1$
- $r > 0$：正相关（$x\uparrow→y\uparrow$）
- $r < 0$：负相关（$x\uparrow→y\downarrow$）
- 相关性强度：
  - $0.8 \leq |r| \leq 1$：强相关
  - $0.5 \leq |r| < 0.8$：中等相关
  - $0.3 \leq |r| < 0.5$：弱相关
  - $|r| < 0.3$：几乎不相关

#### (2) 一元线性回归
| 概念    | 公式                                                                        | 说明                      |
| ----- | ------------------------------------------------------------------------- | ----------------------- |
| 回归方程  | $\hat{y} = \hat{b}x + \hat{a}$                                            | 预测模型                    |
| 斜率估计  | $\hat{b} = \frac{\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^{n}(x_i-\bar{x})^2}$ | 变化率                     |
| 截距估计  | $\hat{a} = \bar{y} - \hat{b}\bar{x}$                                      | 基准值                     |
| 残差    | $e_i = y_i - \hat{y}_i$                                                   | 预测误差                    |
| 残差平方和 | $SSE = \sum e_i^2$                                                        | 越小模型越好                  |
| 总平方和  | $SST = \sum (y_i-\bar{y})^2$                                              | 数据总变异                   |
| 判定系数  | $R^2 = 1 - \frac{SSE}{SST}$                                               | 拟合优度（$0\leq R^2\leq 1$） |

**显著性检验**：
- $H_0: b=0$（无线性关系）
- 检验统计量：$t = \frac{\hat{b}}{SE(\hat{b})} \sim t(n-2)$
- 若 $|t| > t_{\alpha/2}(n-2)$，拒绝 $H_0$

---

### 4. 独立性检验（2×2列联表）
#### 列联表示例
|          | 特征B+ | 特征B- | 合计  |
| -------- | ---- | ---- | --- |
| **特征A+** | a    | b    | a+b |
| **特征A-** | c    | d    | c+d |
| **合计**   | a+c  | b+d  | n   |

#### 卡方检验步骤
1. **建立假设**：
   - $H_0$：特征A与B独立
   - $H_1$：特征A与B相关

2. **计算期望频数**：
   $$E_{ij} = \frac{(\text{行合计}) \times (\text{列合计})}{\text{总样本量}}$$
   例如：$E_{11} = \frac{(a+b)(a+c)}{n}$

3. **卡方统计量**：
   $$\chi^2 = \sum \frac{(O_{ij} - E_{ij})^2}{E_{ij}} = \frac{n(ad-bc)^2}{(a+b)(c+d)(a+c)(b+d)}$$

4. **决策规则**：
   - 若 $\chi^2 \geq \chi_{\alpha}^2(1)$，拒绝 $H_0$
   - $\alpha=0.05$ 时临界值 $\chi_{0.05}^2(1)=3.841$

---

### 5. 统计活动设计
#### 完整流程
```mermaid
graph LR
A[确定研究目标] --> B[设计抽样方案]
B --> C[收集数据]
C --> D[数据预处理]
D --> E[统计分析]
E --> F[结果解释]
F --> G[撰写报告]